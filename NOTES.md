# Notes

- https://github.com/Schniz/fnm
- https://nuxt.com/docs/getting-started/installation
- `rm -rf node_modules/ .nuxt`
- `npm install -D nuxt @nuxtjs/eslint-config-typescript eslint-plugin-nuxt eslint @nuxtjs/tailwindcss`
- `npm install -D @nuxt/image@rc`
- `npm install slugify`
- `npm install -D slugify`
- `npm install -D eslint-plugin-tailwindcss`
- `npm install @vueuse/core` or `npm install -D @vueuse/nuxt @vueuse/core`
- `npm install -D vercel`
- `npm install vue-social-media-icons`
- https://nuxt.com/docs/api/commands/prepare
- https://nuxt.com/docs/guide/directory-structure/server
- https://github.com/c1llo/gallery
- https://nuxt.com/docs/examples/hello-world
- https://github.com/nuxt-modules/eslint
- https://tailwindcss.com/docs/guides/nuxtjs#3
- https://nuxt.com/modules
- https://github.com/nuxt/eslint-config
- https://github.com/nuxt/eslint-plugin-nuxt
- https://github.com/nuxt/eslint-config/blob/main/packages/eslint-config/package.json
- https://github.com/nuxt/eslint-config/blob/main/packages/eslint-config/index.js
- https://eslint.org/docs/latest/use/configure/configuration-files
- https://github.com/nuxt/eslint-config/tree/main/packages/eslint-config-legacy
- https://github.com/nuxt/eslint-config/tree/main/packages/eslint-config-legacy-typescript
- https://github.com/nuxt/content/blob/main/.eslintrc + https://github.com/nuxt/content/blob/main/package.json + https://github.com/nuxt/image/blob/main/package.json
- https://ui.nuxtlabs.com/getting-started
- https://tailwindcss.nuxtjs.org/examples/nuxtlabs-ui
- https://www.npmjs.com/package/eslint-plugin-tailwindcss
- https://tailwindcss.com/docs/translate#hardware-acceleration
- https://heroicons.com/
- https://lucide.dev/
- https://nuxt.com/modules/icons
- https://tailwindui.com/
- https://spotlight.tailwindui.com/ + https://ui.nuxtlabs.com/getting-started + https://ark-ui.com/docs/vue/overview/getting-started
- https://headlessui.com/
- https://www.anron.pro/
- https://www.adobe.com/express/discover/sizes/photo-aspect-ratio
- https://vercel.com/docs/cli/deploying-from-cli
- https://github.com/lucide-icons/lucide/blob/main/icons/instagram.svg?short_path=e435f4b
- https://www.npmjs.com/package/lucide-vue-next?activeTab=code
- https://nuxt.com/docs/guide/concepts/typescript
- https://eslint.vuejs.org/rules/multi-word-component-names.html + https://github.com/nuxt/content/blob/main/.eslintrc + https://github.com/nuxt/eslint-plugin-nuxt/issues/189
- https://github.com/nuxt/nuxt/issues/6830
- https://github.com/francoismassart/eslint-plugin-tailwindcss/blob/master/docs/rules/classnames-order.md
- https://knowledge.evinced.com/elements/landmarks/aside + https://imgs.so/posts/39345d
- https://github.com/nuxt-modules/fontaine
- https://tailwindui.com/documentation
- https://github.com/evilmartians/mono + https://github.com/evilmartians/mono/releases
- https://rsms.me/inter + https://github.com/rsms/inter/releases
- https://evilmartians.com/chronicles/the-joy-of-variable-fonts-getting-started-on-the-frontend
- https://uploadcare.com/pricing/
- https://support.cloudinary.com/hc/en-us/articles/202520592-Do-you-have-a-file-size-limit-
- https://dev.to/jacobandrewsky/optimized-images-in-nuxt-with-cloudinary-4897 + https://github.com/nuxt-modules/cloudinary
- https://faizalwestcott.com/lisbon-22
- https://nuxt.com/docs/api/commands/cleanup
- https://medium.com/design-bridges/optical-effects-9fca82b4cd9a
- https://github.com/cpsoinos/nuxt-svgo
- https://github.com/jpkleemans/vite-svg-loader + https://github.com/damianstasik/vue-svg-loader/issues/180
- https://github.com/nuxt-community/svg-module
- https://github.com/shrpne/vue-inline-svg
- https://github.com/shadcn-ui/ui/blob/main/tailwind.config.cjs
- https://ui.shadcn.com/docs/theming
- https://ui.shadcn.com/docs/components/button#outline + https://ui.shadcn.com/docs/components/button#with-icon
- https://tailwindui.com/components/application-ui/elements/buttons
- `focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-neutral-900 focus-visible:ring-offset-2`
- https://vercel.com/docs/cli:
  - Build Command: `npm run generate`
  - Install Command: `npm install`
  - Development Command: `npm run dev`
- https://github.com/nuxt/image/issues/757 + https://github.com/unjs/nitro/pull/1073
- https://github.com/nuxt/image/issues/689#issuecomment-1399187132
- https://github.com/nuxt/image/issues/617
- https://vercel.com/docs/frameworks/nuxt#nuxt-route-middleware-on-vercel
- `npm cache clean --force`
- https://github.com/nuxt/nuxt/issues/22083 + https://github.com/nuxt/nuxt/issues/22072
- https://github.com/nuxt/image/issues/933 + https://github.com/nuxt/image/issues/893
- https://github.com/nuxt/image/pull/882
- https://www.opengraph.xyz/
- https://github.com/nuxt-community/svg-module/issues/86
- https://github.com/kiwilan/nuxt-svg-transformer
- https://www.localcan.com/
- https://github.com/sdras/vue-sample-svg-icons/blob/master/src/components/IconBase.vue
- https://v2.vuejs.org/v2/cookbook/editable-svg-icons.html
- https://ui.shadcn.com/docs/components/button#icon
- https://nuxt.com/docs/guide/directory-structure/app-config
- https://github.com/Atinux/content-wind/blob/main/app.config.ts
- https://nuxt.com/docs/api/composables/use-app-config
- https://github.com/Atinux/content-wind/blob/main/components/AppLayout.vue
- https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/Date
- https://dev.to/timothee/using-modulo-to-shift-a-value-and-keep-it-inside-a-range-8fm
- https://nuxt.com/docs/guide/directory-structure/composables
- https://github.com/c1llo/gallery/blob/main/src/pages/index.vue
- https://github.com/c1llo/gallery/blob/main/src/composables/useImages.ts
- https://nuxt.com/docs/api/composables/use-head + https://nuxt.com/docs/api/composables/use-seo-meta
- https://github.com/harlan-zw/zhead/blob/main/src/metaFlat.ts
- https://github.com/nuxt/cli:
  - https://github.com/nuxt/cli/blob/v3.10.1/src/commands/init.ts#L13
  - https://github.com/nuxt/starter/blob/templates/templates/v3.json
  - https://github.com/unjs/citty: CLI builder
  - https://nuxt.com/docs/guide/directory-structure/pages
  - https://nuxt.com/docs/examples/routing/pages
- https://nuxt.com/docs/getting-started/configuration#external-configuration-files: "Use `vite` key in `nuxt.config`"
- https://nuxt.com/docs/getting-started/views#layouts: "If you only have a single layout in your application, we recommend using `app.vue` with `<NuxtPage />` instead."
- https://github.com/nuxt/nuxt/issues/23475
- Prettier:
  - https://github.com/nuxt/website-v2/blob/main/.prettierrc
  - https://github.com/nuxt/nuxters/blob/main/prettier.config.cjs
  - https://github.com/nuxt/cli/blob/main/.prettierrc
- Global styling:
  - https://nuxt.com/docs/getting-started/styling#the-css-property: "The stylesheets will be inlined in the HTML rendered by Nuxt, injected globally and present in all pages."
  - https://nuxt.com/docs/getting-started/styling#stylesheets-distributed-through-npm: `export default defineNuxtConfig({ css: ['animate.css'] })`

## Snippets

### `middleware/trailing-slash.global.ts`

```ts
// Source: https://blog.adriaan.io/redirect-trailing-slashes-in-nuxt-3.html
// https://nuxt.com/docs/guide/directory-structure/middleware#what-order-middleware-runs-in
// https://github.com/unjs/ufo
// https://nuxt.com/docs/api/utils/define-nuxt-route-middleware
// https://router.vuejs.org/api/interfaces/RouteLocationNormalized.html

import { withoutTrailingSlash } from 'ufo'

export default defineNuxtRouteMiddleware(to => {
  if (to.path !== '/' && to.path.endsWith('/')) {
    const newPath = withoutTrailingSlash(to.path)

    return navigateTo(newPath, { redirectCode: 308 })
  }
})
```

### Divider

```vue
<template>
  <div>
    <hr v-for="n in Number(route.params.id)" :key="n" class="my-4 border-neutral-200" />
  </div>
</template>
```

### First version

#### `tailwind.config.ts`

```ts
// https://tailwindcss.nuxtjs.org/tailwind/config#merging-strategy
// https://github.com/tailwindlabs/tailwindcss/blob/v3.3.2/stubs/config.full.js#L27
// https://tailwindcss.com/docs/aspect-ratio
// https://github.com/tailwindlabs/tailwindcss/discussions/1739
// https://tailwindcss.com/docs/font-family#providing-default-font-settings

import type { Config } from 'tailwindcss'
import defaultTheme from 'tailwindcss/defaultTheme'

export default <Partial<Config>>{
  theme: {
    extend: {
      aspectRatio: {
        photo: '3 / 2'
      },
      gridTemplateColumns: {
        photo: '5fr 1fr'
      },
      fontFamily: {
        sans: ['Inter var', ...defaultTheme.fontFamily.sans]
      }
    }
  },
  future: {
    hoverOnlyWhenSupported: true
  }
}
```

#### `photos.config.ts`

```ts
import slugify from 'slugify'

function m(month: number): number {
  return month - 1
}

interface Photo {
  src: string
  location: string
  date: Date
}

interface Collection {
  name: string
  photos: Photo[]
}

const collections: Collection[] = [
  {
    name: 'Black & Night',
    photos: [
      {
        src: '/_MG_5561-2.jpg',
        location: 'Lisbon, Portugal',
        date: new Date(2023, m(1), 1)
      },
      {
        src: '/_MG_5561-2v.jpg',
        location: 'Lisbon, Portugal',
        date: new Date(2023, m(1), 1)
      },
      {
        src: 'https://placehold.co/600x400',
        location: 'Lisbon, Portugal',
        date: new Date(2023, m(1), 1)
      },
      {
        src: 'https://placehold.co/1000x4000',
        location: 'Lisbon, Portugal',
        date: new Date(2023, m(1), 1)
      },
      {
        src: 'https://placehold.co/600x400',
        location: 'Lisbon, Portugal',
        date: new Date(2023, m(1), 1)
      },
      {
        src: 'https://placehold.co/600x400',
        location: 'Lisbon, Portugal',
        date: new Date(2023, m(1), 1)
      }
    ]
  }
]

export default {
  name: 'JoÃ£o Palmeiro',
  instagram: 'https://www.instagram.com/joaompalmeiro/',
  portraitMode: 'https://portraitmode.io/profile/joaopalmeiro/',
  gitHub: 'https://github.com/joaopalmeiro/photography-website',
  collections: collections.map(collection => {
    const slug = slugify(collection.name, { lower: true })
    const photos = collection.photos.map((photo, index) => {
      const id = index + 1

      return {
        ...photo,
        id
      }
    })

    return { ...collection, slug, photos }
  })
}
```

#### `nuxt.config.ts`

```ts
// https://tailwindcss.nuxtjs.org/getting-started/setup
// https://nuxt.com/docs/api/configuration/nuxt-config#css
// https://tailwindui.com/documentation#optional-add-the-inter-font-family
// https://nuxt.com/docs/api/configuration/nuxt-config#head
// https://image.nuxtjs.org/configuration#dir + https://nuxt.com/docs/getting-started/assets
// https://nuxt.com/docs/api/configuration/nuxt-config#generate + https://nitro.unjs.io/config#prerender
// https://nitro.unjs.io/config#routerules
// https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/307
// https://nuxt.com/docs/api/configuration/nuxt-config#payloadextraction
// https://github.com/nuxt/nuxt/issues/22068

import type { NitroConfig } from 'nitropack'
import config from './photos.config'

const dynamicPhotoRoutes: string[] = config.collections
  .map(collection => collection.photos.map(photo => `/${collection.slug}/${photo.id}`))
  .flat()

const collectionToFirstPhoto = config.collections.reduce<NitroConfig['routeRules']>((acc, collection) => {
  const from = `/${collection.slug}`
  const fromSlash = `${from}/`

  const to = `${from}/1`

  return {
    ...acc,
    [from]: { redirect: { to, statusCode: 307 } },
    [fromSlash]: { redirect: { to, statusCode: 307 } }
  }
}, {})

export default defineNuxtConfig({
  modules: ['@nuxtjs/tailwindcss', '@nuxt/image', '@vueuse/nuxt'],
  tailwindcss: {
    viewer: false
  },
  css: ['@/assets/font.css'],
  // app: {
  //   head: {
  //     link: [
  //       { rel: 'preconnect', href: 'https://rsms.me/' },
  //       { rel: 'stylesheet', href: 'https://rsms.me/inter/inter.css' }
  //     ]
  //   }
  // }
  image: {
    dir: 'assets/images',
    provider: 'ipx'
  },
  nitro: {
    prerender: { crawlLinks: false, ignore: [], routes: dynamicPhotoRoutes },
    routeRules: collectionToFirstPhoto
  }
})
```

#### `components/InternalLink.vue`

```vue
<script setup lang="ts">
  defineProps<{
    to: string
  }>()
</script>

<template>
  <NuxtLink
    :to="to"
    class="rounded-md border border-neutral-200 bg-white p-2 text-neutral-700 transition-colors hover:bg-neutral-50 hover:text-neutral-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-neutral-900 focus-visible:ring-offset-2"
  >
    <slot />
  </NuxtLink>
</template>
```

#### `pages/[collection]/[id].vue`

```vue
<!-- https://gallery-nuxt.vercel.app/ -->
<!-- https://nuxt.com/docs/api/utils/navigate-to -->
<!-- https://nuxt.com/docs/api/composables/use-router#based-on-history-api -->
<!-- https://github.com/c1llo/gallery/blob/main/src/composables/useGalleryNavigation.ts -->
<!-- https://stackoverflow.com/questions/63244683/detecting-whether-a-click-has-been-made-to-the-left-side-or-on-the-right-side-of -->
<!-- https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/clientY -->
<!-- https://developer.mozilla.org/en-US/docs/Web/API/Window/innerWidth -->
<!-- https://devhints.io/wip/intl-datetime -->
<!-- https://image.nuxtjs.org/components/nuxt-img#quality (100, 90, 80 or 55) -->
<!-- class="max-h-[40rem]" -->
<!-- https://image.nuxtjs.org/configuration#screens -->
<!-- https://sharp.pixelplumbing.com/api-output#webp -->
<!-- https://stackoverflow.com/questions/15295697/make-an-image-to-fit-its-parent-dimensions -->
<!-- https://nuxt.com/docs/api/utils/create-error -->
<!-- https://github.com/c1llo/gallery/blob/main/src/layouts/gallery.vue#L18 -->
<!-- https://image.nuxtjs.org/components/nuxt-img#preload or https://image.nuxtjs.org/components/nuxt-img#loading -->
<!-- https://stackoverflow.com/questions/46699452/how-to-set-max-height-to-a-css-grid -->
<!-- https://vuejs.org/guide/essentials/list.html#v-for-with-a-range -->
<!-- https://vueuse.org/core/useSwipe/ -->
<!-- https://github.com/vueuse/vueuse/blob/main/packages/core/useSwipe/demo.vue -->
<!-- https://flowbite.com/docs/components/bottom-navigation/ -->

<script setup lang="ts">
  import { ChevronLeftIcon, ChevronRightIcon, HomeIcon } from '@heroicons/vue/24/outline'

  const route = useRoute()
  const { collections, name } = useAppConfig()

  const swipeableEl = ref<HTMLElement | null>(null)
  const { direction } = useSwipe(swipeableEl, {
    onSwipeEnd() {
      if (direction.value === 'right') {
        handlePrev()
      }
      if (direction.value === 'left') {
        handleNext()
      }
    }
  })

  const dateFormatter = new Intl.DateTimeFormat('en-US', {
    year: 'numeric',
    month: 'short',
    day: '2-digit'
  })

  const currentCollection = collections.find(collection => collection.slug === route.params.collection)

  const currentCollectionName = currentCollection?.name
  const numberPhotos = currentCollection?.photos.length

  const currentPhoto = currentCollection?.photos.find(photo => photo.id.toString() === route.params.id)

  if (!currentPhoto) {
    throw createError({
      statusCode: 404,
      message: 'Photo not found',
      fatal: true
    })
  }

  const currentPhotoSrc = currentPhoto?.src
  const currentPhotoLocation = currentPhoto?.location
  const currentPhotoDate = dateFormatter.format(currentPhoto?.date)

  const pagination = `${route.params.id} of ${numberPhotos}`

  const PREV_NAVIGATION_KEYS = ['ArrowLeft', 'ArrowUp', 'a', 'A', 'w', 'W']
  const NEXT_NAVIGATION_KEYS = ['ArrowRight', 'ArrowDown', 'd', 'D', 's', 'S']

  const prevPath = computed(() => {
    if (numberPhotos && currentPhoto) {
      const newId = getNextImageId(currentPhoto.id, -1, numberPhotos)

      return `/${route.params.collection}/${newId}`
    }

    return route.path
  })

  const nextPath = computed(() => {
    if (numberPhotos && currentPhoto) {
      const newId = getNextImageId(currentPhoto.id, 1, numberPhotos)

      return `/${route.params.collection}/${newId}`
    }

    return route.path
  })

  async function handlePrev() {
    await navigateTo(prevPath.value)
  }

  async function handleNext() {
    await navigateTo(nextPath.value)
  }

  onKeyStroke(PREV_NAVIGATION_KEYS, handlePrev)
  onKeyStroke(NEXT_NAVIGATION_KEYS, handleNext)
  onKeyStroke('Escape', async () => await navigateTo('/'))

  useSeoMeta({
    title: () => `${currentCollectionName} ${route.params.id}`,
    ogTitle: () => `${currentCollectionName} ${route.params.id}`,
    description: () => `A photo by ${name}.`,
    ogDescription: () => `A photo by ${name}.`,
    author: () => name
  })
</script>

<template>
  <main class="grid grid-cols-none gap-8 px-4 pt-4 md:grid-cols-photo md:p-0">
    <div ref="swipeableEl" class="flex items-center justify-center md:h-screen md:py-8 md:pl-8">
      <NuxtImg :src="currentPhotoSrc" :quality="80" class="max-h-full max-w-full object-contain" />
    </div>

    <div class="flex flex-col justify-between md:py-8 md:pr-8">
      <div
        class="fixed bottom-0 left-0 z-50 flex w-full justify-center gap-2 border-t border-neutral-100 bg-white p-4 md:static md:z-auto md:justify-start md:border-0 md:p-0"
      >
        <InternalLink to="/" class="cursor-zoom-out">
          <HomeIcon class="h-6 w-6" />
        </InternalLink>
        <div class="m-2 rounded-md border border-neutral-100" />
        <InternalLink :to="prevPath" class="cursor-w-resize">
          <ChevronLeftIcon class="h-6 w-6" />
        </InternalLink>
        <InternalLink :to="nextPath" class="cursor-e-resize">
          <ChevronRightIcon class="h-6 w-6" />
        </InternalLink>
      </div>

      <div class="flex flex-col gap-4 pb-[6.5rem] text-neutral-900 md:pb-0">
        <div class="flex flex-col leading-8">
          <h2 class="text-xl">
            {{ currentCollectionName }}
          </h2>
          <span class="font-medium tabular-nums">{{ pagination }}</span>
        </div>

        <div class="flex flex-col text-sm leading-6">
          <span>{{ currentPhotoLocation }}</span>
          <span>{{ currentPhotoDate }}</span>
        </div>
      </div>
    </div>
  </main>
</template>
```

## Commands

```bash
npm install nuxt vue vue-router && npm install -D npm-run-all2 prettier sort-package-json
```

```bash
npx nuxi@latest init test
```
